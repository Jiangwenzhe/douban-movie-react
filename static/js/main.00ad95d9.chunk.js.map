{"version":3,"sources":["components/card.js","components/Cards.js","components/laoding.js","components/Panel.js","components/tabs.js","App.js","serviceWorker.js","index.js"],"names":["Card","_ref","info","react_default","a","createElement","className","href","alt","src","images","medium","title","rating","average","collect_count","year","genres","join","directors","map","i","name","casts","Cards","_this$props","this","props","value","cardInfo","item","index","key","card","Component","Loading","Panel","_this","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","state","startNum","countNum","hasMore","isLoading","scrollpx","try_restore_component","bind","assertThisInitialized","handleScroll","getTopMovieData","setTopMovieData","_this2","_this$state","requestURL","setState","url","concat","josnp","error","data","console","log","subjects","_this$state2","total","Array","from","Set","_this$state3","windowHeight","window","innerHeight","document","documentElement","offsetHeight","body","html","docHeight","Math","max","scrollHeight","clientHeight","windowBottom","pageYOffset","panelData","sessionStorage","getItem","JSON","parse","_panelData","_this$state4","addEventListener","scrollTo","prevProps","removeEventListener","_this$state5","setItem","stringify","_this$state6","components_Cards","laoding","SingleTabButton","tabName","icon","to","activeOnlyWhenExact","react_router","path","exact","children","_ref2","match","react_router_dom","style","color","TopPanel","components_Panel","OnTheaterPanel","SearchPanel","searchTerm","onSearchChange","onSearchSubmit","event","target","forceUpdate","searchData","_searchData","type","placeholder","onChange","id","onClick","Tabs","tabs_SingleTabButton","process","component","App","tabs","Boolean","location","hostname","ReactDOM","render","src_App_0","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.00ad95d9.chunk.js","sourcesContent":["import React from 'react';\nimport '../App.css';\n\nconst Card = ({info}) =>\n <div className=\"card\">\n   <a href={info.alt}>\n      <div className=\"cover\"><img  src={info.images.medium}  alt=\"\"/></div>\n      <div className=\"detail\">\n        <h2>{info.title}</h2>\n        <div className=\"extra\">\n          <span className=\"score\">{info.rating.average}</span>&nbsp;/&nbsp;\n          <span className=\"collection\">{info.collect_count}</span> 收藏\n        </div>\n        <div className=\"extra\">\n          <span className=\"year\">{info.year}</span>&nbsp;/&nbsp;\n          <span className=\"type\">{info.genres.join('、')}</span>\n        </div>\n        <div className=\"extra\">\n          <span className=\"director\">导演: {info.directors.map(i => i.name).join('、')}</span>\n        </div>\n        <div className=\"extra\">\n          <span className=\"casts\">演员: {info.casts.map(i => i.name).join('、')}</span>\n        </div>\n        <div className=\"extra\"></div>\n      </div>\n    </a>\n  </div>\n\nexport default Card;","import React, { Component } from 'react';\nimport './style.css';\nimport Card from './card';\n\n\nclass Cards extends Component {\n  render() {\n    const { value, cardInfo } = this.props;\n    return(\n      <div>\n        <h1>{value}</h1>\n        {cardInfo.map((item,index) =>\n          <div key={index}>\n            <Card info={item}/>\n          </div>\n        )}\n      </div>\n    )\n  }\n}\nexport default Cards;","import React from 'react';\nimport './style.css'\n\nconst Loading = () =>\n<div className=\"loading\">\n  <span className=\"iconfont icon-jiazai_dan\"></span>\n</div>\n\nexport default Loading;","import React, { Component } from 'react';\nimport Cards from './Cards';\nimport Loading from './laoding';\nimport josnp from 'jsonp';\n\n\n\n\nclass Panel extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      cardInfo: null,\n      startNum: 0,\n      countNum: 20,\n      hasMore: true,\n      isLoading: false,\n      scrollpx: 0\n    };\n    this.try_restore_component = this.try_restore_component.bind(this);\n    this.try_restore_component();\n    this.handleScroll = this.handleScroll.bind(this);\n    this.getTopMovieData = this.getTopMovieData.bind(this);\n    this.setTopMovieData = this.setTopMovieData.bind(this);\n  }\n\n  getTopMovieData() {\n    const {startNum, countNum } = this.state;\n    const { requestURL } = this.props;\n    this.setState({\n      isLoading: true\n    });\n    let url = `${requestURL}?start=${startNum}&count=${countNum}`\n    josnp(url,null,\n      (error, data) => {\n        if(error) {\n          console.log(error);\n        } else {\n          console.log(data.subjects);\n          this.setState({\n            startNum: startNum + 20,\n            isLoading: false\n          });\n          this.setTopMovieData(data);\n          console.log('get data startNum: ', startNum)\n        }\n    });\n  }\n\n  setTopMovieData(data) {\n    const { cardInfo, startNum, countNum, hasMore } = this.state;\n    const { subjects, total } = data;\n    if(cardInfo) {\n      this.setState({\n        cardInfo: Array.from(new Set(cardInfo.concat(subjects))),\n        hasMore: (total>=(startNum+ countNum))\n      })\n      console.log(hasMore)\n\n    } else {\n      this.setState({\n        cardInfo: subjects\n      })\n    }\n  }\n\n  handleScroll(){\n    const { isLoading, hasMore } = this.state;\n    const windowHeight = \"innerHeight\" in window ? window.innerHeight : document.documentElement.offsetHeight;\n    const body = document.body;\n    const html = document.documentElement;\n    const docHeight = Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight,  html.scrollHeight, html.offsetHeight);\n    const windowBottom = windowHeight + window.pageYOffset;\n    // console.log(windowBottom, \"  ---   \", docHeight)\n    // console.log('windowBottom: ', windowBottom)\n    this.setState({\n      scrollpx: window.pageYOffset\n    })\n    if (windowBottom >= docHeight) {\n      console.log('页面到底啦')\n      if(!isLoading && hasMore) {\n        this.getTopMovieData();\n      }\n      console.log('发送请求。。。')\n    }\n  }\n\n  try_restore_component() {\n    const { value } = this.props\n    let panelData = window.sessionStorage.getItem(`${value}`);\n    console.log('try_restore_component');\n    if(panelData) {\n      panelData = JSON.parse(panelData);\n      console.log(panelData)\n      const { cardInfo, startNum, countNum, hasMore, isLoading, scrollpx } = panelData;\n      this.state = ({\n        cardInfo : cardInfo,\n        scrollpx: scrollpx,\n        startNum: startNum,\n        countNum: countNum,\n        hasMore: hasMore,\n        isLoading: isLoading,\n      });\n    }\n  }\n\n  componentDidMount() {\n    console.log('did Mount')\n    const { startNum , scrollpx } = this.state;\n    console.log('在did Mount中的', scrollpx);\n    window.addEventListener(\"scroll\", this.handleScroll);\n    if(startNum === 0) {\n      console.log('一开始获取数据')\n      this.getTopMovieData();\n     }\n    window.scrollTo(0, scrollpx);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.requestURL !== prevProps.requestURL) {\n      this.setState({\n        startNum: 0,\n        cardInfo: null\n      })\n      this.getTopMovieData();\n    }\n  }\n\n  componentWillUnmount() {\n    console.log('unmount')\n    window.removeEventListener(\"scroll\", this.handleScroll);\n    const { cardInfo, startNum, countNum, hasMore, scrollpx } = this.state;\n    console.log('保存的电影数据', cardInfo);\n    console.log('滚动的位置', scrollpx);\n    let panelData = {\n      cardInfo : cardInfo,\n      scrollpx: scrollpx,\n      startNum: startNum,\n      countNum: countNum,\n      hasMore: hasMore,\n      isLoading: false,\n    }\n    window.sessionStorage.setItem(`${this.props.value}`, JSON.stringify(panelData));\n  }\n\n  render() {\n    const { cardInfo, isLoading } = this.state;\n\n    return (\n      <div>\n       {cardInfo && <Cards cardInfo = {cardInfo}  />}\n       {isLoading && <Loading />}\n      </div>\n    );\n\n  }\n\n}\n\nexport default Panel;","import React, { Component}  from 'react';\nimport { BrowserRouter as Router, Route, Link, Redirect} from \"react-router-dom\";\nimport './style.css';\nimport Panel from './Panel';\n\nconst Tabs = () =>\n  <Router>\n    <div>\n    <footer className=\"backdrop-blur\">\n      <SingleTabButton\n        activeOnlyWhenExact={true}\n        to=\"/top250\"\n        icon=\"iconfont icon-paihangbang\"\n        tabName=\"排行榜\"\n      />\n      <SingleTabButton\n        to=\"/onTheater\"\n        icon=\"iconfont icon-dianying\"\n        tabName=\"正在上映\"\n      />\n      <SingleTabButton\n        to=\"/search\"\n        icon=\"iconfont icon-search\"\n        tabName=\"搜索\"\n      />\n      </footer>\n      {/* 默认路由 */}\n      <Route exact path={process.env.PUBLIC_URL + '/'} component={() => <Redirect to=\"/top250\"/>} />\n      <Route exact path={process.env.PUBLIC_URL + '/top250'} component={TopPanel} />\n      <Route path={process.env.PUBLIC_URL + '/onTheater'} component={OnTheaterPanel} />\n      <Route path={process.env.PUBLIC_URL + '/search'} component={SearchPanel }/>\n    </div>\n  </Router>\n\nconst SingleTabButton = ({ tabName, icon , to, activeOnlyWhenExact }) =>\n  <Route\n    path={to}\n    exact={activeOnlyWhenExact}\n    children={({ match }) => (\n      <div className={match ? \"active\" : \"\"}>\n        <span className={icon}></span>\n        <Link style={match ? {color: '#00B51D'}: {}}  to={to}>{tabName}</Link>\n      </div>\n    )}\n  />\n\n\nconst TopPanel = () =>\n  <Panel requestURL=\"https://api.douban.com/v2/movie/top250\" value=\"topmovie\"/>\n\n\nconst OnTheaterPanel = () =>\n  <Panel requestURL=\"https://api.douban.com/v2/movie/in_theaters\" value=\"in_theater\"/>\n\nclass SearchPanel extends Component {\n  constructor() {\n    super();\n    this.state = {\n      searchTerm: '',\n      url: ''\n    }\n\n    this.onSearchChange = this.onSearchChange.bind(this);\n    this.onSearchSubmit = this.onSearchSubmit.bind(this);\n    this.try_restore_component = this.try_restore_component.bind(this);\n    this.try_restore_component();\n  }\n\n  onSearchChange(event) {\n    this.setState({ searchTerm: event.target.value });\n  }\n\n  onSearchSubmit(event) {\n    // event.preventDefault();\n    const { searchTerm } = this.state;\n    this.setState({\n      url: `https://api.douban.com/v2/movie/search?q=${searchTerm}`\n    });\n    this.forceUpdate();\n  }\n\n  try_restore_component() {\n    let searchData = window.sessionStorage.getItem('searchData');\n    console.log(searchData)\n    if(searchData) {\n      searchData = JSON.parse(searchData);\n      let { url , searchTerm} = searchData;\n      this.state = {\n        url: url,\n        searchTerm: searchTerm\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    const { url, searchTerm } = this.state;\n    console.log(url)\n    let searchData = {\n      url: url,\n      searchTerm: searchTerm\n    }\n    window.sessionStorage.setItem('searchData', JSON.stringify(searchData));\n  }\n\n  render() {\n    const { url , searchTerm } = this.state\n    return (\n      <div>\n        <div className=\"search-area\">\n          <input type=\"text\"  placeholder=\"搜索电影\" value={searchTerm} onChange={this.onSearchChange}/>\n          <span className=\"button\" id=\"searchBtn\" onClick={this.onSearchSubmit}> 搜索</span>\n        </div>\n        {url && <Panel requestURL={url} value={searchTerm}/>}\n      </div>\n    );\n  }\n}\n\n\n\n\nexport default Tabs","import React, { Component } from 'react';\nimport './App.css';\nimport Tabs from './components/tabs'\n\nclass App extends Component {\n  render() {\n    return (\n      <div>\n        <Tabs />\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\nserviceWorker.unregister();\nif(module.hot) {\n  module.hot.accept();\n}\n"],"sourceRoot":""}